var jnedfd=new Array();var jnedinst=new Array();var jareaids=new Array();var jphpareaids=new Array();function jAppW(){this.buttons=new Array();this.autocheckVar=false;this.onDOMready=function(codePassed){jCore.DOMcodeToFire.push(codePassed);if(jCore.DOMfctset===false){this.browserDOMready()}};this.browserDOMready=function(){jCore.DOMfctset=true;if(document.addEventListener){setTimeout(function(){jCore.DOMready()},100)}else{if(/WebKit/i.test(navigator.userAgent)){var _timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){clearInterval(_timer);jCore.DOMready()}},10)}else{window.onload=jCore.DOMready}}};this.run=function(namekey,extra,htmlEntity,RemoteLoader){var btn=this.buttons[namekey];this.form=eval("document."+btn.formName);if(btn.validation&&!this.validate(btn.formName)){return false}if(btn.pagi){this.navPagi(btn.limitstart,extra)}var fn=btn.formName;var f=document.forms[fn];var l=f.elements.length;fn="#"+fn;app.formdata=new FormData($(fn)[0]);var i=0;if(btn.task){app.formdata.append("task",btn.task)}if(btn.controller){app.formdata.append("controller",btn.controller)}if(btn.lstg){if(typeof extra!="undefined"&&extra.zval){btn.zval=extra.zval}var a=["zact","zsid","zmap","zval","zsc","myId"];var l=a.length;for(var i=0;i<l;i++){if(btn[a[i]]){app.formdata.append(a[i],btn[a[i]])}}if(extra.myId){app.formdata.append("eid",extra.myId)}}var temp=angular.element($("#main_body")).scope();temp.goTo(null);return false;return false};this.beforeAutosave=function(namekey,extra,htmlEntity){var btn=this.buttons[namekey];if(typeof btn=="undefined"){return true}this.form=eval("document."+btn.formName);this.loadNeditData();return true};this.autocheck=function(button,extra){extra.value=$(extra.namekey).value;if(extra.value==""||extra.value==0){return true}notexist=extra.notexist;var form=eval("document."+button.formName);var task=eval(form.task);if(task){form.task.value=button.task}var extraStr="";for(var i in extra){index=i;extraStr+="&"+i+"="+extra[i]}var url=button.ajxUrl;jQuery.ajax({url:url,data:jQuery(form).serialize()+extraStr+"&controller=output",method:"POST",success:function(msg){if(notexist==1){if(msg==0){msg=1}else{msg=0}}if(msg==1){joobi.autocheckVar=true}else{joobi.autocheckVar=false}}})};this.processTask=function(btn,extra){if(typeof btn=="undefined"){return}if(btn.ajx){if(btn.zsid){extra.zsid=btn.zsid}if(btn.zmap){extra.zmap=btn.zmap}if(btn.zsc){extra.zsc=btn.zsc}}else{if(typeof extra!="undefined"&&extra.zval){btn.zval=extra.zval}var a=["zact","zsid","zmap","zval","zsc","myId"];var l=a.length;for(var i=0;i<l;i++){if(btn[a[i]]){var input=jQuery("<input>").attr("type","hidden").attr("name",a[i]).val(btn[a[i]]);jQuery("#"+btn.formName).append(jQuery(input))}}}switch(btn.task){case"order":if(btn.total){for(var j=0;j<=btn.total;j++){box=eval("this.form.em"+j);if(box){box.checked=true}}}else{this.checkLine(extra)}break;default:if(extra.em){this.tickBox(extra.em)}}if(btn.sorting){this.form.sorting.value=extra;task=btn.params}};this.numChecked=function(idName){if(jCore.termVal==jCore.termCtn){return"true"}else{alert(jCore.termMsg);return""}};this.tickBox=function(id){box=eval("this.form."+id);if(box){box.checked=true;this.form.boxchecked.value=1}else{return false}};this.checkbox=function(button,extra){switch(button.task){case"toggleAllBox":box=$(button.checkid);var i=button.limitstart;var currentElement=eval("this.form.em"+i);while(currentElement){em=jQuery("#em"+i);em.prop("checked",box.prop("checked"));i++;currentElement=eval("this.form.em"+i)}if(extra){this.form.boxchecked.value=i}else{this.form.boxchecked.value=0}break;case"checkLine":this.checkLine(extra);break}return true};this.flip=function(htmlId,msg){htmlEntity=$(htmlId);if(msg){msgEntity=$("msg"+htmlId)}if(htmlEntity.style.display=="none"){htmlEntity.style.display="block";if(msg){msgEntity.style.display="none"}}else{htmlEntity.style.display="none";if(msg){msgEntity.style.display="block"}}};this.flipChild=function(htmlId){htmlEntity=$(htmlId);var i=0;for(i=0;i<htmlEntity.childNodes.length;i++){if(htmlEntity.childNodes[i].style.display=="none"){htmlEntity.childNodes[i].style.display="block"}else{htmlEntity.childNodes[i].style.display="none"}}};this.checkLine=function(boxid){boxRadio=eval("this.form."+boxid);parentObj=boxRadio;runaway=false;while(!runaway){if(parentObj){parentObj=parentObj.parentNode}if(parentObj&&parentObj.nodeName=="BODY"){return false}if(parentObj&&parentObj.nodeName=="TR"){runaway=true}if(!parentObj){return false}}parentid=parentObj.getAttribute("id");box=document.getElementById(boxid);row=document.getElementById(parentid);if(row.className){row.className=jQuery.trim(row.className)}if(row.className.indexOf("rowSelected")==-1){if(box.checked==true){box.checked=false}}if(row.className.indexOf("rowSelected")!=-1){if(box.checked==false){box.checked=true}}if(box.checked==true){box.checked=false;this.form.boxchecked.value--;row.className=row.className.substring(0,4)}else{if(box.type=="radio"){if(this.form.boxchecked.value==1){this.form.boxchecked.value--}var tr=document.getElementsByTagName("tr");for(var i=0;i<tr.length;i++){cssclass=tr[i].className;if(cssclass.indexOf("rowSelected")!=-1){cssclass=cssclass.substring(0,4);tr[i].className=cssclass}}}box.checked=true;this.form.boxchecked.value++;row.className+=" rowSelected"}return true};this.changeFilter=function(limitname){limitstart=eval("this.form."+limitname);if(limitstart){limitstart.value=""}};this.navPagi=function(limitname,extra){limitstart=eval("this.form."+limitname);limitstart.value=extra};this.popClose=function(){return window.parent.SqueezeBox.close()};this.validate=function(formname){if(!(typeof validateForm=="function")){return true}var status=validateForm(formname);return status};this.checkSelection=function(btn,namekey){var form=eval("document."+btn.formName);if(form.boxchecked.value==0){alert(jCore.msg["selec_"+namekey]);return false}return true};this.askConfirmation=function(namekey){if(confirm(jCore.msg["conf_"+namekey])){return true}else{return false}};this.loadNeditData=function(){for(i=0;i<jnedinst.length;i++){textbox=jQuery("#"+jareaids[i]);if(jnedinst[i].innerHTML=="<br>"){textbox.val("")}else{textbox.val(jnedinst[i].innerHTML)}}return false};this.loadPHPeditData=function(){for(i=0;i<jphpareaids.length;i++){textbox=jQuery("#"+jphpareaids[i]);textbox.val(editAreaLoader.getValue(jphpareaids[i]))}return false};this.sendForm=function(button,namekey,extra){var form=eval("document."+button.formName);var task=eval(form.task);if(task){form.task.value=button.task}if(button.controller){var contro=eval(form.controller);if(contro){contro.value=button.controller}}if(button.ajx==1){jCore.ajxprms.url=button.ajxUrl;var url=jCore.ajxprms.url;jCore.ajxprms.on=button.ajx;jCore.ajxprms.extfct=button.ajxComplete;var extraData="";var evals=0;if(button.ajaxToggle){jCore.ajxprms.div=extra.divId;var extraStr="";for(var i in extra){index=i;extraStr+="&"+i+"="+extra[i]}extraData="&ajax=1&namekey="+namekey+extraStr;evals=1}else{jCore.ajxprms.div="div"+button.formName}var func=eval("window."+jCore.ajxprms.extfct);if(func){jQuery.ajax({url:url,data:jQuery(form).serialize(),method:"POST",async:false,success:function(msg){func(msg,url,form)}})}else{jQuery.ajax({url:url,data:jQuery(form).serialize()+extraData,async:false,method:"POST",success:function(msg){jwriteResponse(msg,"","",0,evals)}})}}else{try{jQuery(form).submit()}catch(e){}status=form.submit()}if(button.refresh){parent.location.reload()}else{if(button.popclose){this.popClose()}}return true};this.wait=function(msecs){var start=new Date().getTime();var cur=start;while(cur-start<msecs){cur=new Date().getTime()}};this.wizard=function(button){};this.creditcard=function(namekey,cardnameid,cardnumid,expdateid){var btn=this.buttons[namekey];var formName=btn.formName;if(!this.validate(formName)){return false}if(!checkCreditCard(cardnameid,cardnumid)){return false}this.sendForm(btn);return false}}var joobi=new jAppW();var jCore={confirm:[],nedit:false,ajxprms:[],DOMfctset:false,DOMcodeToFire:[],msg:[],req:[],txtA:[],termCtn:"",termMsg:"",termVal:0,DOMready:function(){for(i=0;i<jCore.DOMcodeToFire.length;i++){jCore.DOMcodeToFire[i]()}}};function jwriteResponse(msg,div,classes,append,evals){if(!div){div=jCore.ajxprms.div}if(!classes){classes=jCore.ajxprms.extfct}var evaluateJS=evals;mydiv=jQuery(div);if(mydiv){if(append){jQuery(div).append(msg)}else{if((evaluateJS)&&(msg)&&(msg.indexOf("noeval")===-1)){evaluateJS=1}else{evaluateJS=0}if(evaluateJS){eval(msg)}else{jQuery(div).html(msg)}}}};