var jnedfd=new Array();var jnedinst=new Array();var jareaids=new Array();var jphpareaids=new Array();jQuery(document).keypress(function(d){if(d.which==13){var a=d.target.id;for(var c in jCore.txtA){if(typeof jCore.txtA[c]!="undefined"){var b="xt_"+jCore.txtA[c];if(a==jCore.txtA[c]||a==b){return true}}}if(typeof jCore.prssEnter!="undefined"){joobi.run(jCore.prssEnter)}}});function termsChecked(a){if(a){jCore.termVal+=1}else{jCore.termVal-=1}}function wzClosePopUp(b,a){if(typeof b!="undefined"&&b){jQuery("#wzpOpUp").modal("hide");location.reload()}else{if(typeof a!="undefined"&&a){jQuery("#wzpOpUp").modal("hide")}}}function jAppW(){this.buttons=new Array();this.autocheckVar=false;this.onDOMready=function(codePassed){jCore.DOMcodeToFire.push(codePassed);if(jCore.DOMfctset===false){this.browserDOMready()}};this.browserDOMready=function(){jCore.DOMfctset=true;jCore.flagIE=false;if(!jCore.flagIE){if(document.addEventListener){document.addEventListener("DOMContentLoaded",jCore.DOMready,null)}else{if(/WebKit/i.test(navigator.userAgent)){var _timer=setInterval(function(){if(/loaded|complete/.test(document.readyState)){clearInterval(_timer);jCore.DOMready()}},10)}else{window.onload=jCore.DOMready}}}};this.run=function(namekey,extra,htmlEntity){var curButton=this.buttons[namekey];this.form=eval("document."+curButton.formName);if(curButton.wizard){return this.wizard(curButton)}if(curButton.autocheck){return this.autocheck(curButton,extra)}if(curButton.nosubmit){return this.checkbox(curButton,extra)}if(curButton.rqCk&&!this.numChecked(curButton.rqCkCl)){return false}if(curButton.listing){this.processTask(curButton,extra)}if(curButton.select&&!this.checkSelection(curButton,namekey)){return false}if(curButton.confirm&&!this.askConfirmation(namekey)){return false}this.loadNeditData();if(curButton.phpedit){this.loadPHPeditData()}if(curButton.validation&&!this.validate(curButton.formName)){return false}if(curButton.pagi){this.navPagi(curButton.limitstart,extra)}if(curButton.cfil){this.changeFilter(curButton.limitstart)}if(curButton.disable&&htmlEntity){window.WApps.helpers.changeButtons(htmlEntity)}if(curButton.disableAll){this.disableAll()}this.sendForm(curButton,namekey,extra);return false};this.beforeAutosave=function(namekey,extra,htmlEntity){var curButton=this.buttons[namekey];if(typeof btn=="undefined"){return true}this.form=eval("document."+curButton.formName);this.loadNeditData();if(curButton.phpedit){this.loadPHPeditData()}return true};this.wizard=function(button){myElement=$("viewWizard");var display=myElement.getStyle("display");if(display=="none"){myElement.setStyle("display","block")}else{myElement.setStyle("display","none")}var form=eval("document."+button.formName);var task=eval(form.task);if(task){form.task.value=button.task}jCore.ajxprms.url=button.ajxUrl;var url=jCore.ajxprms.url;var ajax=new Request({url:url,data:$(form).toQueryString()+"&controller=output",method:"POST",onComplete:function(msg){}});ajax.send()};this.loadjQuery=function(path){var jquerys=$("jquery");if(jquerys==null){this.loadjs(path+"jquery-1.5.1.min.js","jquery")}};this.loadjs=function(path,id){if(path!=""){var script=document.createElement("script");script.setAttribute("type","text/javascript");script.setAttribute("src",path);if(id!=""){script.setAttribute("id",id)}document.getElementsByTagName("head")[0].appendChild(script)}};this.autocheck=function(button,extra){extra.value=$(extra.namekey).value;if(extra.value==""||extra.value==0){return true}notexist=extra.notexist;var form=eval("document."+button.formName);var task=eval(form.task);if(task){form.task.value=button.task}var extraStr="";for(var i in extra){index=i;extraStr+="&"+i+"="+extra[i]}var url=button.ajxUrl;var ajax=new Request({url:url,data:$(form).toQueryString()+extraStr+"&controller=output",method:"POST",onComplete:function(msg){if(notexist==1){if(msg==0){msg=1}else{msg=0}}if(msg==1){joobi.autocheckVar=true}else{joobi.autocheckVar=false}}});ajax.send()};this.creditcard=function(namekey,cardnameid,cardnumid,expdateid){var curButton=this.buttons[namekey];var formName=curButton.formName;if(!this.validate(formName)){return false}if(!checkCreditCard(cardnameid,cardnumid)){return false}this.sendForm(curButton);return false};this.processTask=function(btn,extra){if(typeof btn=="undefined"){return}if(btn.ajx){if(btn.zsid){extra.zsid=btn.zsid}if(btn.zmap){extra.zmap=btn.zmap}if(btn.zsc){extra.zsc=btn.zsc}}else{if(typeof extra!="undefined"&&extra.zval){btn.zval=extra.zval}var a=["zact","zsid","zmap","zval","zsc"];var l=a.length;for(var i=0;i<l;i++){if(btn[a[i]]){var input=jQuery("<input>").attr("type","hidden").attr("name",a[i]).val(btn[a[i]]);jQuery("#"+btn.formName).append(jQuery(input))}}}switch(btn.task){case"order":if(btn.total){for(var j=0;j<=btn.total;j++){box=eval("this.form.em"+j);if(box){box.checked=true}}}else{this.checkLine(extra)}break;default:if(extra.em){this.tickBox(extra.em)}}if(btn.sorting){this.form.sorting.value=extra;task=btn.params}};this.numChecked=function(idName){if(jCore.termVal==jCore.termCtn){return"true"}else{alert(jCore.termMsg);return""}};this.tickBox=function(id){box=eval("this.form."+id);if(box){box.checked=true;this.form.boxchecked.value=1}else{return false}};this.disableAll=function(){menuHori=$("joobiMenu");if(menuHori){$("joobiMenu").parentNode.parentNode.setStyle("display","none")}cmsToolbar=$("header-box");if(cmsToolbar){cmsToolbar.setStyle("display","none")}};this.checkbox=function(button,extra){switch(button.task){case"toggleAllBox":box=$(button.checkid);var i=button.limitstart;var currentElement=eval("this.form.em"+i);while(currentElement){em=jQuery("#em"+i);em.prop("checked",box.prop("checked"));i++;currentElement=eval("this.form.em"+i)}if(extra){this.form.boxchecked.value=i}else{this.form.boxchecked.value=0}break;case"checkLine":this.checkLine(extra);break}return true};this.flip=function(htmlId,msg){htmlEntity=$(htmlId);if(msg){msgEntity=$("msg"+htmlId)}if(htmlEntity.style.display=="none"){htmlEntity.style.display="block";if(msg){msgEntity.style.display="none"}}else{htmlEntity.style.display="none";if(msg){msgEntity.style.display="block"}}};this.flipChild=function(htmlId){htmlEntity=$(htmlId);var i=0;for(i=0;i<htmlEntity.childNodes.length;i++){if(htmlEntity.childNodes[i].style.display=="none"){htmlEntity.childNodes[i].style.display="block"}else{htmlEntity.childNodes[i].style.display="none"}}};this.checkLine=function(boxid){boxRadio=eval("this.form."+boxid);parentObj=boxRadio;runaway=false;while(!runaway){if(parentObj){parentObj=parentObj.parentNode}if(parentObj&&parentObj.nodeName=="BODY"){return false}if(parentObj&&parentObj.nodeName=="TR"){runaway=true}if(!parentObj){return false}}parentid=parentObj.getAttribute("id");box=document.getElementById(boxid);row=document.getElementById(parentid);if(row.className){row.className=jQuery.trim(row.className)}if(row.className.indexOf("rowSelected")==-1){if(box.checked==true){box.checked=false}}if(row.className.indexOf("rowSelected")!=-1){if(box.checked==false){box.checked=true}}if(box.checked==true){box.checked=false;this.form.boxchecked.value--;row.className=row.className.substring(0,4)}else{if(box.type=="radio"){if(this.form.boxchecked.value==1){this.form.boxchecked.value--}var tr=document.getElementsByTagName("tr");for(var i=0;i<tr.length;i++){cssclass=tr[i].className;if(cssclass.indexOf("rowSelected")!=-1){cssclass=cssclass.substring(0,4);tr[i].className=cssclass}}}box.checked=true;this.form.boxchecked.value++;row.className+=" rowSelected"}return true};this.changeFilter=function(limitname){limitstart=eval("this.form."+limitname);if(limitstart){limitstart.value=""}};this.navPagi=function(limitname,extra){limitstart=eval("this.form."+limitname);limitstart.value=extra};this.popClose=function(){return window.parent.SqueezeBox.close()};this.validate=function(formname){if(!(typeof validateForm=="function")){return true}var status=validateForm(formname);return status};this.checkSelection=function(curButton,namekey){var form=eval("document."+curButton.formName);if(form.boxchecked.value==0){alert(jCore.msg["selec_"+namekey]);return false}return true};this.askConfirmation=function(namekey){if(confirm(jCore.msg["conf_"+namekey])){return true}else{return false}};this.loadNeditData=function(){for(i=0;i<jnedinst.length;i++){textbox=jQuery("#"+jareaids[i]);if(jnedinst[i].innerHTML=="<br>"){textbox.val("")}else{textbox.val(jnedinst[i].innerHTML)}}return false};this.loadPHPeditData=function(){for(i=0;i<jphpareaids.length;i++){textbox=jQuery("#"+jphpareaids[i]);textbox.val(editAreaLoader.getValue(jphpareaids[i]))}return false};this.sendForm=function(button,namekey,extra){var form=eval("document."+button.formName);var task=eval(form.task);if(task){form.task.value=button.task}if(button.controller){var contro=eval(form.controller);if(contro){contro.value=button.controller}}if(button.ajx==1){jCore.ajxprms.url=button.ajxUrl;var url=jCore.ajxprms.url;jCore.ajxprms.on=button.ajx;jCore.ajxprms.extfct=button.ajxComplete;var extraData="";var action="eval";if(button.ajaxToggle){var extraStr="";jCore.ajxprms.div=extra.divId;if(extra.act){action=extra.act}for(var i in extra){index=i;extraStr+="&"+i+"="+extra[i]}extraData="&ajax=1&namekey="+namekey+extraStr}else{jCore.ajxprms.div="div"+button.formName}var func=eval("window."+jCore.ajxprms.extfct);if(typeof joobiAjax!="undefined"){joobiAjax.run(url,button,form);return true}if(func){jQuery.ajax({url:url,data:jQuery(form).serialize(),method:"POST",async:false,success:function(msg){func(msg,url,form)}})}else{jQuery.ajax({url:url,data:jQuery(form).serialize()+extraData,async:false,method:"POST",success:function(msg){WAjaxResp(msg,jCore.ajxprms.div,action)}})}}else{try{jQuery(form).submit()}catch(e){}status=form.submit()}if(typeof jCore.isAdmin!="undefined"&&jCore.isAdmin=="admin"){if(button.refresh){parent.location.reload()}else{if(button.popclose){return window.parent.SqueezeBox.close()}}}else{window.parent.wzClosePopUp(button.refresh,button.popclose)}return true};this.wait=function(msecs){var start=new Date().getTime();var cur=start;while(cur-start<msecs){cur=new Date().getTime()}}}var joobi=new jAppW();var jCore={confirm:[],nedit:false,ajxprms:[],DOMfctset:false,DOMcodeToFire:[],msg:[],req:[],txtA:[],termCtn:"",termMsg:"",termVal:0,DOMready:function(){for(i=0;i<jCore.DOMcodeToFire.length;i++){jCore.DOMcodeToFire[i]()}}};function WAjaxResp(c,d,b){var a="";return jwriteResponse(c,d,a,b)}function jwriteResponse(msg,div,classes,action){if(!msg){return}if(!action){action="html"}if("eval"!=action&&div[0]!="#"){div="#"+div}mydiv=jQuery(div);if(mydiv){if("append"==action){jQuery(div).append(msg)}else{if("replace"==action){jQuery(div).replaceWith(msg)}else{if("html"==action){jQuery(div).html(msg)}else{eval(msg)}}}}}var mylist=new Array();function makeImgList(b,a){if(b==true){mylist.push(a)}else{var c=new Array();for(i=0;i<mylist.length;i++){if(mylist[i]!=a){c.push(mylist[i])}}mylist=c}}function processImages(){window.parent.document.getElementById("sbox-window").close();for(i=0;i<mylist.length;i++){window.parent.jnedfd[0].execCommand("insertImage",false,mylist[i])}};