if(typeof jeroenwijering=="undefined"){var jeroenwijering=new Object();jeroenwijering.utils=new Object()}jeroenwijering.Player=function(b,c,a){this.controller;this.model;this.view;this.configuration={backgroundcolor:"FFFFFF",windowless:"false",file:"",height:"260",image:"",backcolor:"FFFFFF",frontcolor:"000000",lightcolor:"000000",screencolor:"000000",width:"320",logo:"",overstretch:"false",shownavigation:"true",showstop:"false",showdigits:"true",usefullscreen:"true",usemute:"false",autostart:"false",bufferlength:"3",duration:"0",repeat:"false",sender:"",start:"0",volume:"90",link:"",linkfromdisplay:"false",linktarget:"_self"};for(itm in this.configuration){if(a[itm]!=undefined){if(itm.indexOf("color")>0){this.configuration[itm]=a[itm].substr(a[itm].length-6)}else{this.configuration[itm]=a[itm]}}}Silverlight.createObjectEx({source:c,parentElement:b,properties:{width:this.configuration.width,height:this.configuration.height,version:"1.0",inplaceInstallPrompt:true,isWindowless:this.configuration.windowless,background:"#"+this.configuration.backgroundcolor},events:{onLoad:this.onLoadHandler,onError:null},context:this})};jeroenwijering.Player.prototype={addListener:function(a,b){this.view.listeners.push({type:a,func:b})},getConfig:function(){return this.configuration},onLoadHandler:function(a,c,b){c.configuration.sender=b;c.controller=new jeroenwijering.Controller(c.configuration);c.view=new jeroenwijering.View(c.configuration,c.controller);c.model=new jeroenwijering.Model(c.configuration,c.controller,c.view);c.controller.startMVC(c.view,c.model)},sendEvent:function(b,a){switch(b.toUpperCase()){case"LINK":this.controller.setLink();break;case"LOAD":this.controller.setLoad(a);break;case"MUTE":this.controller.setMute();break;case"PLAY":this.controller.setPlay();break;case"SCRUB":this.controller.setScrub(a);break;case"STOP":this.controller.setStop();break;case"VOLUME":this.controller.setVolume(a);break}}};jeroenwijering.Controller=function(a){this.configuration=a};jeroenwijering.Controller.prototype={startMVC:function(b,a){this.view=b;this.model=a;if(this.configuration.usemute=="true"){this.view.onVolume(0);this.view.onMute(true);this.model.goVolume(0)}else{this.view.onVolume(this.configuration.volume);this.model.goVolume(this.configuration.volume)}if(this.configuration.autostart=="true"){this.model.goStart()}else{this.model.goPause()}},setState:function(a,b){this.state=b;var c=this.configuration.start;if(a=="Closed"&&c>0){setTimeout(jeroenwijering.utils.delegate(this,this.setScrub),200,c)}},setLink:function(){if(this.configuration.linktarget.indexOf("javascript:")==0){return Function(this.configuration.linktarget).apply()}else{if(this.configuration.linktarget=="_blank"){window.open(this.configuration.link)}else{if(this.configuration.linktarget!=""){window.location=this.configuration.link}}}},setLoad:function(a){if(this.model.state!="Closed"){this.model.goStop()}this.configuration.file=a;if(this.configuration.autostart=="true"){setTimeout(jeroenwijering.utils.delegate(this.model,this.model.goStart),100)}},setMute:function(){if(this.configuration.usemute=="true"){this.configuration.usemute="false";this.model.goVolume(this.configuration.volume);this.view.onMute(false)}else{this.configuration.usemute="true";this.model.goVolume(0);this.view.onMute(true)}},setPlay:function(){if(this.state=="Buffering"||this.state=="Playing"){if(this.configuration.duration==0){this.model.goStop()}else{this.model.goPause()}}else{this.model.goStart()}},setScrub:function(a){if(a<2){a=0}else{if(a>this.configuration.duration-4){a=this.configuration.duration-4}}if(this.state=="Buffering"||this.state=="Playing"){this.model.goStart(a)}else{this.model.goPause(a)}},setStop:function(){this.model.goStop()},setVolume:function(a){if(a<0){a=0}else{if(a>100){a=100}}this.configuration.volume=Math.round(a);this.model.goVolume(a);this.view.onVolume(a);if(this.configuration.usemute=="true"){this.configuration.usemute="false";this.view.onMute(false)}},setFullscreen:function(){var a=!this.configuration.sender.getHost().content.FullScreen;this.configuration.sender.getHost().content.FullScreen=a;jeroenwijering.utils.delegate(this.view,this.view.onFullscreen)}};jeroenwijering.View=function(a,b){this.configuration=a;this.listeners=Array();this.controller=b;this.fstimeout;this.fslistener;this.display=this.configuration.sender.findName("PlayerDisplay");this.controlbar=this.configuration.sender.findName("PlayerControls");this.configuration.sender.getHost().content.onResize=jeroenwijering.utils.delegate(this,this.resizePlayer);this.configuration.sender.getHost().content.onFullScreenChange=jeroenwijering.utils.delegate(this,this.onFullscreen);this.assignColorsClicks();this.resizePlayer()};jeroenwijering.View.prototype={onBuffer:function(b){var a=this.configuration.sender;if(b==0){a.findName("BufferText").Text=null}else{b<10?b="0"+b:b=""+b;a.findName("BufferText").Text=b}this.delegate("BUFFER",[b])},onFullscreen:function(c){var a=this.configuration.sender;var b=a.getHost().content.FullScreen;if(b){this.fstimeout=setTimeout(jeroenwijering.utils.delegate(this,this.hideFSControls),2000);this.fslistener=this.display.addEventListener("MouseMove",jeroenwijering.utils.delegate(this,this.showFSControls));a.findName("FullscreenSymbol").Visibility="Collapsed";a.findName("FullscreenOffSymbol").Visibility="Visible"}else{clearTimeout(this.fstimeout);this.display.removeEventListener("MouseMove",this.fslistener);this.controlbar.Visibility="Visible";this.display.Cursor="Hand";a.findName("FullscreenSymbol").Visibility="Visible";a.findName("FullscreenOffSymbol").Visibility="Collapsed"}this.resizePlayer();this.delegate("FULLSCREEN")},showFSControls:function(d,a){var b=d.findName("PlayerControls");var c=a.GetPosition(b).Y;clearTimeout(this.fstimeout);this.controlbar.Visibility="Visible";this.display.Cursor="Hand";if(c<0){this.fstimeout=setTimeout(jeroenwijering.utils.delegate(this,this.hideFSControls),2000)}},hideFSControls:function(){this.controlbar.Visibility="Collapsed";this.display.Cursor="None"},onLoad:function(c){var b=this.configuration.sender;var a=b.findName("TimeSlider").Width;b.findName("DownloadProgress").Width=Math.round(a*c/100);this.delegate("LOAD",[c])},onMute:function(b){var a=this.configuration.sender;this.configuration.usemute=""+b;if(b){a.findName("VolumeHighlight").Visibility="Collapsed";a.findName("MuteSymbol").Visibility="Visible";a.findName("MuteOffSymbol").Visibility="Collapsed";if(this.state=="Playing"){a.findName("MuteIcon").Visibility="Visible"}}else{a.findName("VolumeHighlight").Visibility="Visible";a.findName("MuteSymbol").Visibility="Collapsed";a.findName("MuteOffSymbol").Visibility="Visible";a.findName("MuteIcon").Visibility="Collapsed"}this.delegate("MUTE")},onState:function(b,d){var a=this.configuration.sender;this.state=d;if(d=="Buffering"||d=="Playing"||d=="Opening"){a.findName("PlayIcon").Visibility="Collapsed";a.findName("PlaySymbol").Visibility="Collapsed";a.findName("PlayOffSymbol").Visibility="Visible";if(d=="Playing"){a.findName("BufferIcon").Visibility="Collapsed";a.findName("BufferText").Visibility="Collapsed";if(this.configuration.usemute=="true"){a.findName("MuteIcon").Visibility="Visible"}}else{a.findName("BufferIcon").Visibility="Visible";a.findName("BufferText").Visibility="Visible"}}else{a.findName("MuteIcon").Visibility="Collapsed";a.findName("BufferIcon").Visibility="Collapsed";a.findName("BufferText").Visibility="Collapsed";a.findName("PlayOffSymbol").Visibility="Collapsed";a.findName("PlaySymbol").Visibility="Visible";if(this.configuration.linkfromdisplay=="true"){a.findName("PlayIcon").Visibility="Collapsed"}else{a.findName("PlayIcon").Visibility="Visible"}}try{if(!(b=="Completed"&&d=="Buffering")&&!(b=="Buffering"&&d=="Paused")){playerStatusChange(b.toUpperCase(),d.toUpperCase())}}catch(c){}this.delegate("STATE",[b,d])},onTime:function(d,c){var b=this.configuration.sender;var b=this.configuration.sender;var a=b.findName("TimeSlider").Width;if(c>0){var e=Math.round(a*d/c);this.configuration.duration=c;b.findName("ElapsedText").Text=jeroenwijering.utils.timestring(d);b.findName("RemainingText").Text=jeroenwijering.utils.timestring(c-d);b.findName("TimeSymbol").Visibility="Visible";b.findName("TimeSymbol")["Canvas.Left"]=e+4;b.findName("TimeHighlight").Width=e-2}else{b.findName("TimeSymbol").Visibility="Collapsed"}this.delegate("TIME",[d,c])},onVolume:function(b){var a=this.configuration.sender;a.findName("VolumeHighlight").Width=Math.round(b/5);this.delegate("VOLUME",[b])},assignColorsClicks:function(){this.display.Cursor="Hand";this.display.Background="#FF"+this.configuration.screencolor;if(this.configuration.linkfromdisplay=="false"){this.display.addEventListener("MouseLeftButtonUp",jeroenwijering.utils.delegate(this.controller,this.controller.setPlay))}else{this.display.addEventListener("MouseLeftButtonUp",jeroenwijering.utils.delegate(this.controller,this.controller.setLink));this.display.findName("PlayIcon").Visibility="Collapsed"}if(this.configuration.logo!=""){this.display.findName("OverlayCanvas").Visibility="Visible";this.display.findName("OverlayLogo").ImageSource=this.configuration.logo}this.controlbar.findName("ControlbarBack").Fill="#FF"+this.configuration.backcolor;this.assignButton("Play",this.controller.setPlay);this.assignButton("Stop",this.controller.setStop);this.configuration.sender.findName("ElapsedText").Foreground="#FF"+this.configuration.frontcolor;this.assignSlider("Time",this.changeTime);this.configuration.sender.findName("DownloadProgress").Fill="#FF"+this.configuration.frontcolor;this.configuration.sender.findName("RemainingText").Foreground="#FF"+this.configuration.frontcolor;this.assignButton("Link",this.controller.setLink);this.assignButton("Fullscreen",this.controller.setFullscreen);this.assignButton("Mute",this.controller.setMute);this.assignSlider("Volume",this.changeVolume)},assignButton:function(c,a){var b=this.configuration.sender.findName(c+"Button");b.Cursor="Hand";b.addEventListener("MouseLeftButtonUp",jeroenwijering.utils.delegate(this.controller,a));b.addEventListener("MouseEnter",jeroenwijering.utils.delegate(this,this.rollOver));b.addEventListener("MouseLeave",jeroenwijering.utils.delegate(this,this.rollOut));this.configuration.sender.findName(c+"Symbol").Fill="#FF"+this.configuration.frontcolor;try{this.configuration.sender.findName(c+"OffSymbol").Fill="#FF"+this.configuration.frontcolor}catch(d){}},assignSlider:function(c,a){var b=this.configuration.sender.findName(c+"Button");b.Cursor="Hand";b.addEventListener("MouseLeftButtonUp",jeroenwijering.utils.delegate(this,a));b.addEventListener("MouseEnter",jeroenwijering.utils.delegate(this,this.rollOver));b.addEventListener("MouseLeave",jeroenwijering.utils.delegate(this,this.rollOut));this.configuration.sender.findName(c+"Slider").Fill="#FF"+this.configuration.frontcolor;this.configuration.sender.findName(c+"Highlight").Fill="#FF"+this.configuration.frontcolor;this.configuration.sender.findName(c+"Symbol").Fill="#FF"+this.configuration.frontcolor},delegate:function(c,a){for(var b=0;b<this.listeners.length;b++){if(this.listeners[b]["type"].toUpperCase()==c){this.listeners[b]["func"].apply(null,a)}}},rollOver:function(c){var b=c.Name.substr(0,c.Name.length-6);this.configuration.sender.findName(b+"Symbol").Fill="#FF"+this.configuration.lightcolor;try{this.configuration.sender.findName(b+"OffSymbol").Fill="#FF"+this.configuration.lightcolor}catch(a){}},rollOut:function(c){var b=c.Name.substr(0,c.Name.length-6);this.configuration.sender.findName(b+"Symbol").Fill="#FF"+this.configuration.frontcolor;try{this.configuration.sender.findName(b+"OffSymbol").Fill="#FF"+this.configuration.frontcolor}catch(a){}},changeTime:function(e,b){var a=e.findName("TimeSlider");var c=b.GetPosition(a).X;var d=Math.floor(c/a.Width*this.configuration.duration);this.controller.setScrub(d)},changeVolume:function(d,a){var c=d.findName("VolumeButton");var b=a.GetPosition(c).X;this.controller.setVolume(b*5)},resizePlayer:function(){var b=this.configuration.sender.getHost().content.actualWidth;var c=this.configuration.sender.getHost().content.actualHeight;var a=this.configuration.sender.getHost().content.FullScreen;if(this.configuration.shownavigation=="true"){if(a==true){this.resizeDisplay(b,c);this.controlbar["Canvas.Left"]=Math.round(b/2-250);this.resizeControlbar(500,c-this.controlbar.Height-16);this.controlbar.findName("ControlbarBack")["Opacity"]=0.5}else{this.resizeDisplay(b,c-20);this.controlbar["Canvas.Left"]=0;this.resizeControlbar(b,c-this.controlbar.Height);this.controlbar.findName("ControlbarBack")["Opacity"]=1}}else{this.resizeDisplay(b,c)}},resizeDisplay:function(a,b){this.stretchElement("PlayerDisplay",a,b);this.stretchElement("VideoWindow",a,b);this.stretchElement("PlaceholderImage",a,b);this.centerElement("PlayIcon",a,b);this.centerElement("MuteIcon",a,b);this.centerElement("BufferIcon",a,b);this.centerElement("BufferText",a,b);this.display.findName("OverlayCanvas")["Canvas.Left"]=a-this.display.findName("OverlayCanvas").Width-10;this.display.Visibility="Visible"},resizeControlbar:function(d,f,a){this.controlbar["Canvas.Top"]=f;this.stretchElement("PlayerControls",d);this.stretchElement("ControlbarBack",d);this.placeElement("PlayButton",0);var c=17;this.placeElement("VolumeButton",d-24);this.placeElement("MuteButton",d-37);var b=37;if(this.configuration.showstop=="true"){this.placeElement("StopButton",c);c+=17}else{this.controlbar.findName("StopButton").Visibility="Collapsed"}if(this.configuration.usefullscreen=="true"){b+=18;this.placeElement("FullscreenButton",d-b)}else{this.controlbar.findName("FullscreenButton").Visibility="Collapsed"}if(this.configuration.link!=""){b+=18;this.placeElement("LinkButton",d-b)}else{this.controlbar.findName("LinkButton").Visibility="Collapsed"}if(this.configuration.showdigits=="true"&&d-b-c>160){b+=35;this.controlbar.findName("RemainingButton").Visibility="Visible";this.controlbar.findName("ElapsedButton").Visibility="Visible";this.placeElement("RemainingButton",d-b);this.placeElement("ElapsedButton",c);c+=35}else{this.controlbar.findName("RemainingButton").Visibility="Collapsed";this.controlbar.findName("ElapsedButton").Visibility="Collapsed"}this.placeElement("TimeButton",c);this.stretchElement("TimeButton",d-c-b);this.stretchElement("TimeShadow",d-c-b);this.stretchElement("TimeStroke",d-c-b);this.stretchElement("TimeFill",d-c-b);this.stretchElement("TimeSlider",d-c-b-10);this.stretchElement("DownloadProgress",d-c-b-10);var e=this.configuration.sender.findName("TimeSymbol");this.stretchElement("TimeHighlight",e["Canvas.Left"]-5);this.controlbar.Visibility="Visible"},centerElement:function(b,a,d){var c=this.configuration.sender.findName(b);c["Canvas.Left"]=Math.round(a/2-c.Width/2);c["Canvas.Top"]=Math.round(d/2-c.Height/2)},stretchElement:function(b,a,d){var c=this.configuration.sender.findName(b);c.Width=a;if(d!=undefined){c.Height=d}},placeElement:function(b,a,c){var d=this.configuration.sender.findName(b);d["Canvas.Left"]=a;if(c){d["Canvas.Top"]=c}}};jeroenwijering.Model=function(a,b,d){this.configuration=a;this.controller=b;this.view=d;this.video=this.configuration.sender.findName("VideoWindow");this.preview=this.configuration.sender.findName("PlaceholderImage");var c={"true":"UniformToFill","false":"Uniform",fit:"Fill",none:"None"};this.state=this.video.CurrentState;this.timeint;this.video.Stretch=c[this.configuration.overstretch];this.preview.Stretch=c[this.configuration.overstretch];this.video.BufferingTime=jeroenwijering.utils.spanstring(this.configuration.bufferlength);this.video.AutoPlay=true;this.video.AddEventListener("CurrentStateChanged",jeroenwijering.utils.delegate(this,this.stateChanged));this.video.AddEventListener("MediaEnded",jeroenwijering.utils.delegate(this,this.mediaEnded));this.video.AddEventListener("BufferingProgressChanged",jeroenwijering.utils.delegate(this,this.bufferChanged));this.video.AddEventListener("DownloadProgressChanged",jeroenwijering.utils.delegate(this,this.downloadChanged));if(this.configuration.image!=""){this.preview.Source=this.configuration.image}};jeroenwijering.Model.prototype={goPause:function(a){this.video.pause();if(!isNaN(a)){this.video.Position=jeroenwijering.utils.spanstring(a)}this.timeChanged()},goStart:function(a){this.video.Visibility="Visible";this.preview.Visibility="Collapsed";if(this.state=="Closed"){this.video.Source=this.configuration.file}else{this.video.play()}if(!isNaN(a)){this.video.Position=jeroenwijering.utils.spanstring(a)}},goStop:function(){this.video.Visibility="Collapsed";this.preview.Visibility="Visible";this.goPause(0);this.video.Source="null";this.view.onBuffer(0);clearInterval(this.timeint)},goVolume:function(a){this.video.Volume=a/100},stateChanged:function(){var a=this.video.CurrentState;if(a!=this.state){this.controller.setState(this.state,a);this.view.onState(this.state,a);this.state=a;this.configuration.duration=Math.round(this.video.NaturalDuration.Seconds*10)/10;if(a!="Playing"&&a!="Buffering"&&a!="Opening"){clearInterval(this.timeint)}else{this.timeint=setInterval(jeroenwijering.utils.delegate(this,this.timeChanged),100)}}},mediaEnded:function(){if(this.configuration.repeat=="true"){this.goStart(0)}else{this.state="Completed";this.view.onState(this.state,"Completed");this.video.Visibility="Collapsed";this.preview.Visibility="Visible";this.goPause(0)}},bufferChanged:function(){var a=Math.round(this.video.BufferingProgress*100);this.view.onBuffer(a)},downloadChanged:function(){var a=Math.round(this.video.DownloadProgress*100);this.view.onLoad(a)},timeChanged:function(){var a=Math.round(this.video.Position.Seconds*10)/10;this.view.onTime(a,this.configuration.duration)}};jeroenwijering.utils.delegate=function(a,b){return function(){return b.apply(a,arguments)}};jeroenwijering.utils.timestring=function(a){var c=Math.floor(a/3600);var b=Math.floor(a%3600/60);var d=Math.round(a%60);var e="";d>9?e+=d:e+="0"+d;b>9?e=b+":"+e:e="0"+b+":"+e;c>0?e=c+":"+e:null;return e};jeroenwijering.utils.spanstring=function(a){var c=Math.floor(a/3600);var b=Math.floor(a%3600/60);var d=Math.round(a%60*10)/10;var e=c+":"+b+":"+d;return e};